# Disfiguring response summary and generating distorted results by sending out of range responses.


You might have came across various *forms or surveys* where in the *end* you are asked to rate the product or service from 1-10.  At individual scale this *rating*  may seem infinitely small but at the organization level when there are *tons of ratings*  they really get *significant*.

Ratings can be used as an assessment tool to generate *product or service*  likeability. This helps organizations to know whether or not their *product or service* is beneficial to its users.

### Introduction

A service which is being used to *create the rating forms*   for companies later  generated the *analytics* as per the rating  done on their *product or service*. 

Suppose if you had to provide *rating for a product you used recently* it looked like this:

<< Rating pic>>

As you can see *users have to rate from 1 to 5* based on their experience  with the *product or service*. Once the rating phase is completed there is a *mechanism implemented* at the back end which generates the analytics of the *ratings* to help the *companies identify* , what percentage of users have rated *highest or lowest*. The *analytics* looked something as in below ```png```.

{{ analytics png}}

### Attacking phase

>Curiosity is the fuel for discovery,inquiry and learning.                              Anonymous

Just being as curious as you are right now. We started to analyze the *requests* for actions like *submitting the ratings*  and how analytics are generated aftermath. 

There was a simple understandable mechanism which generated the *analytics or summary* of  *rating form*. It was a no brainer but a *simple math implementation*. What actually was happening, *the implemented mechanism counted total ratings*  with respect to the *number on rating scale* and then calculated the *percentage of users*   out of all that have *selected that number* on rating scale.

In simple terms if * i created* a rating form where the users have to rate my *service from* 1 to 5  and there are *4 users* . Three of them *rated number 5* on scale and *one rated number 2* on the scale. Now as a form *admin* if i checked analytics they will be like **75% of  users liked product with 5 rating** and  **25% users are unsatisfied with your product**.

{{Picture}}

Submitting a rating form on server was accomplished via this ```POST HTTP Request``` and the *rating number as per the user's experience*  can be seen in the *request body*.

```http 

vulnerable request
```

## Flipping numbers

A normal assumption which is popping in everyone's mind right now is that, in place of *the numbers in range (1 -5)*  we will send an out of range number *say 10*  and *forward the request* and response was *200 ok*  and yes, we know it is not a big deal yet.

Say *an attacker sent same request 4 times with out of range responses* and as a general *rule they should have no impact* on the *analytics generated for this rating form* because they are out of range responses and can't be counted as a *proper rating*.

Upon checking the *analytics* we were able to see *distorted results* which revealed something like this:

{{Pictre of distorted results}}

These are the analytics of same *rating form which showed* us **75% of  users liked product with 5 rating** and  **25% users are unsatisfied with your product** previously. Now it was showing that **37.45% of users liked product with 5 star rating**  and **12.5% users are unsatisfied with your product with 1 star rating**.

 The issue was not in calculating the *rating responses* to generate analytics  rather it was in *calculating out of range responses as valid ones*.

## Impact

An attacker was completely able to *disfigure the analytics* of a *rating form* which can *prove very damaging* to an organization and can make them *adopt unnecessary strategies for improvemnet*  on their product or service which was never *required*.

## Summary 

- Sending out of range responses on *rating form*.
- Analyzing the *analytics generated by rating*.
- Disfiguring the *analytics generated* by sending multiple out of range responses.
- Triaged and Rewarded.



